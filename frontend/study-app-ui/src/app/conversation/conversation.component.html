<div style="margin-bottom: 70px;"><app-header></app-header></div>
<div class="app-group-chat">
  <app-group-chat></app-group-chat>
</div>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
<div class="backgroundClass" style="width: 78%; flex: 1;">
  <div class="card-header msg_head ">
    <div class="d-flex bd-highlight align-items-center">
      <div class="img_cont">
        <img [src]="grp.pic" alt="Group Image"
          style="width: 60px; height: 60px; margin-top: 7px; margin-left: 7px; border-radius: 50%;"
          class="rounded-circle user_img">
        <span class="online_icon"></span>
      </div>
      <div class="user_info">
        <span>{{grp.name}}</span>
      </div>
      <div class="video_cam" style="margin-left:  6%;">
        <span><i class="fas fa-video"></i></span>
        <span><i class="fas fa-phone"></i></span>
      </div>
      <span id="action_menu_btn" (click)="toggleDropdown()"><i class="fas fa-ellipsis-v"></i></span>

    </div>
    <div class="action_menu" *ngIf="isDropdownOpen" id="action_menu">
      <ul>
        <li><i class="fas fa-users"></i> Add users</li>
        <li (click)="openPopup(groupId)"><i class="fas fa-pencil"></i> Edit the group</li>
        <li (click)="deleteGroup()"><i class="fas fa-ban"></i> Delete the group</li>
      </ul>
    </div>
  </div>
  <div *ngIf="isPopupOpen">
    <app-edit-group></app-edit-group>
  </div>
  <div class="message-container">
    <div class="message-list scrollable-container">
      <ul>
        <div style="display: flex;margin-left: 550px; color: rgb(0, 0, 0);">le groupe {{grp.name}} est créé</div>
        <div *ngFor="let msg of msgs" class="scrollable-container">
          <div *ngIf="groupId == msg.groupId" class="chat-message-right pb-4 scrollable-content"
            style="margin-top: 10px;">
            <div style="display: flex;align-items: center;">
              <div class="msg_cotainer">
                <div>
                  {{ msg.content }}
                </div>
                <img *ngIf="msg.img" [src]="msg.img" alt="" style="height: 100px; border-radius: 10px;">
              </div>
              <div class="img_cont_msg-end">
                <img src="https://static.turbosquid.com/Preview/001292/481/WV/_D.jpg" style="border-radius: 50%;"
                  class="rounded-circle user_img_msg">
              </div>
            </div>
            <span style="display: flex; margin-left: 300px;">{{msg.timestamp}}</span>
          </div>
        </div>

        <div *ngFor="let msg of messages" class="scrollable-container">
          <div *ngIf="groupId == msg.groupId" class="chat-message-right pb-4 scrollable-content"
            style="margin-top: 10px;">
            <div style="display: flex;align-items: center;">
              <div class="msg_cotainer">
                {{ msg.message }}
                <img [src]="msg.img" alt="" style="width: 100px;">
              </div>
              <div class="img_cont_msg-end">
                <img src="https://static.turbosquid.com/Preview/001292/481/WV/_D.jpg" style="border-radius: 50%;"
                  class="rounded-circle user_img_msg">
              </div>
            </div>
            <span style="display: flex; margin-left: 300px;">{{msg.timestamp}}</span>
          </div>
        </div>
      </ul>
    </div>

    <div class="card-footer">
      <div *ngIf="img" (click)="suppImg()"
        style="cursor: pointer; background-color: aliceblue; width: 15px; height: 15px; align-items: center; display: flex; border-radius: 50%; margin-left: 40px; margin-bottom: -15px; position: relative; z-index: 999;">
        <img src="../../../assets/imgs/icons8-x.png" style="height: 10px; width: 10px; margin-left: 2.5px;">
      </div>
      <div class="input-group">
        <label class="input-group-text attach_btn" for="fileInput"><i class="fas fa-paperclip"></i></label>
        <div style="background-color: rgba(0,0,0,0.3);">
          <img [src]="img" alt="" style="height: 60px; border-radius: 10px;">
        </div>
        <input id="fileInput" type="file" (change)="onFileSelected($event)" class="form-control" style="display: none;">
        <input type="text" [(ngModel)]="message" class="form-control type_msg" placeholder="Type your message...">
        <div class="input-group-append">
          <button class="input-group-text send_btn" (click)="sendMessage()">
            <i class="fas fa-location-arrow"></i></button>
        </div>
      </div>
    </div>

  </div>